---
title: "p8105_hw2_dm3175"
author: "Devon Morgan"
date: "9/26/2018"
output: github_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(p8105.datasets)
library("dplyr")
```

# Problem 1: NYC Transit Data
Problem 1 will use NYC Transit Data which includes information on entrance and exits for all subway stations located in New York City. 

## Import and Clean Dataset
The dataset was first imported and cleaned: 

```{r import nyc transit data}
NYC_traffic_data = read_csv(file = "./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv",
                            col_types = "cccddccccccccccccccccclclcccddcc") %>% 
  janitor::clean_names() %>% 
  select(line, station_name, station_latitude, station_longitude, 
       route1:route11, entry, vending, entrance_type, ada) %>% 
  mutate(entry = recode(entry, 'YES' = "TRUE", 'NO' = "FALSE")) %>% 
  mutate(entry = as.logical(entry),
          entrance_type = tolower(entrance_type),
          line = tolower(line),
          station_name = tolower(station_name))
```

## Description of Dataset
The NYC traffic dataset describes information concerning the entrance and exits for all subway stations in New York City, including what subway lines are served by that station, the precise location of entrances, and other information such as staffing, vending and whether the station is compliant under the American Disabilities Act (ADA). 

The dataset was imported and the following data cleaning steps were taken: 

*  Specified column variable types when importing. 

*  Cleaned column names using `janitor::clean_names`

*  Retained the following variables: line, station name, station latitude/longitude, routes served, entry, vending, entrance type, and ADA compliance.

*  Recoded the `entry` variable from a character to a logical variable type using the `recode` function and `as.logical` function. 

*  Converted data in the `line` and `station_name` columns to lower case. 

**Dimensions**: The dataset contains `r nrow(NYC_traffic_data)` rows and `r ncol(NYC_traffic_data)` columns. 

**Is this data tidy?** The dataset is not yet fully tidy, as each separate route and corresponding subway line are separated out into separate columns. Instead, the routes and corresponding subway lines should be collapsed into two columns: route name and route number. This step will be completed in the section below. 

### Questions:

1) **How many distinct stations are there?**

To extract the number of distinct stations, created a subset of data removing duplicates based on both `station_name` and `line`. This dataset still maintains information for all other variables kept above. 
```{r extract distinct stations}
distinct_NYC_traffic_data = distinct(NYC_traffic_data, line, station_name, .keep_all = TRUE)
  
```

There are `r nrow(distinct_NYC_traffic_data)` distinct stations. 

2) **How many stations are ADA compliant?**

There are `r tally(distinct_NYC_traffic_data, ada == TRUE, sort = FALSE)` unique ADA compliant stations. 

3) **What proportion of station entrances / exits without vending allow entrance?**

Use filter to make a filtered dataset based on distinct stations without vending: 
```{r}
filter_distinct_NYC_traffic_data = filter(distinct_NYC_traffic_data, vending == "NO")

```

The proportion of station entrance/exits without vending allowing entrance is `r mean(filter_distinct_NYC_traffic_data$entry)`. 

## Reformat Route Number and Route Name Variables 

tidy_distinct_NYC_traffic_data = 
  gather(distinct_NYC_traffic_data, key = route_number, value = route_name, route1:route11) %>%
  filter(route_name != "NA") %>% 
  arrange(line, station_name)